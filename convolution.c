#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int main()
{
   double a[26] = { 0.256258710002038, 0.963365491187825, -0.743741290000000, 0.963365491190122, 0.256258709998790, -0.450848071183266, 1.25625871000000, -0.450848071189536, 0.256258710000382, 0.963365491183852, -0.743741290000000, 0.963365491188951, 0.256258710000446, -0.450848071184437, 1.25625871000000, -0.450848071188365 };
   double b[26] = { 0.256258710000824, -0.299311523023751, 1.18013824251201, -0.724526570403471, 0.963365491184473, 0.0611683879836982, -0.126424722362053, 1.08772832230303, -0.743741290000000, 1.08772832230147 };
   double y[26], A_new[26], B_new[26], Conv[26], Conv_r[26], k, z, error[25];
   z = pow(2, 14);
   int i, j, m = 16, n = 10, l;
   for ( i = 0; i<= m - 1; i = i + 1 )
   {
       A_new[i] = z * a[i];
       l = (A_new[i]/1);
       k = A_new[i] - l;
       if ( k >= 0.5)
       {
           A_new[i] = (l + 1);//z;
       }
       else
       {
        A_new[i] = l;//z;
       }
    }

   for ( i = 0; i<= n - 1; i++ )
   {
       B_new[i] = z * b[i];
       l = (B_new[i]/1);
       k = B_new[i] - l;
       if ( k >= 0.5)
       {
           B_new[i] = (l + 1);//z;
       }
       else
       {
        B_new[i] = l;//z;
       }
   }

   for( i = m; i <= m + n - 1; i++ )
   {
   a[i] = 0;
   }
   for(i = n; i <= m + n - 1; i++ )
   {
    b[i] = 0;
    B_new[i] = 0;
    }
   for( i = 0; i < m + n - 1; i++ )
   {
       y[i] = 0; Conv[i] = 0;
       for( j = 0; j <= i; j++ )
        {
            y[i] = y[i] + ( a[j] * b[ i - j ] );
            Conv[i] = Conv[i] + ( A_new[j] * B_new[ i - j ] );
            Conv_r[i] = Conv[i]/(z*z);
        }
    }
   for( i = 0; i< m + n - 1; i++ )
       {
           printf("Conv_r[%d]=%.15f \n",i,Conv_r[i]);
       }
    for( i = 0; i< m + n - 1; i++ )
    {
        error[i] = y[i] - Conv_r[i];
        printf("error[%d]=%.15f \n",i,error[i]);
    }
    return 0;
}
