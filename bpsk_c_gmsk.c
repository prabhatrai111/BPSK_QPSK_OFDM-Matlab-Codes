/// PRABHAT KUMAR RAI ///
///  EE18MTECH01005   ///
///  BPSK WITH GMSK   ///


#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>

int main()
{  int input[]={1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1};
   int len = sizeof(input)/sizeof(input[0]), k;
   printf("len of ip=%d\n",len);

   /// Gmsk input ///
   double gmsk_ip[]={0,0,0,0,0,0,0.007,0.0315,0.2605,0.7057,0.9268,0.7057,0.2605,0.0315,0.0007,0,0,0,0,0,0};
   double gmsk_bada[10*len];
   int i, j, samp_fact = 4;
   int gmsk_len = sizeof(gmsk_ip)/sizeof(gmsk_ip[0]);
   int pulse_len = gmsk_len + samp_fact*len - 1;
   double pulse[pulse_len];
   for (i=0;i<2020;i++)
   {  gmsk_bada[i]=0;   }
   for (i=0;i<gmsk_len;i++)
   {  gmsk_bada[i] = gmsk_ip[i];}

   ///  BPSK GENERATION ///
   int ip_bpsk[len], up_input[samp_fact*len];
   for (i=0; i<len; i++)
   {   ip_bpsk[i] = 2*input[i] - 1; }
   memset(up_input, 0, sizeof(up_input));
   memset(pulse, 0, sizeof(pulse));


   ///    UPSAMPLING    ///
   for (i=0; i<len; i++)
   {    j=samp_fact*i;
        up_input[j] = ip_bpsk[i];
        up_input[j+1] = 0;}


   /// CONVOLUTION-SINC ///
   for( i = samp_fact*len; i <= pulse_len; i++ )
   {   up_input[i] = 0;   }
   for( i = 0; i < (pulse_len) ; i++ )
      {   pulse[i] = 0;
           for( j = 0; j <= i; j++ )
             { pulse[i] = pulse[i] + ( up_input[j] * gmsk_bada[ i - j ] );}
      }

   int pul = sizeof(pulse)/sizeof(pulse[0]);
   printf("pulse_leng = %d\n", pul);

   /// NOISE GENERATION ///
   double Noise[]={-0.328525, 0.271754, -0.268579, -0.071968, 1.144206, -0.599082, -0.407211, -0.053679, -0.093672, 1.017746, 1.436320, -0.691693, -0.453272, 0.368032, -0.269196, 1.409159, 1.156735, 0.395286, 0.398552, -0.239283, 0.539980, 0.797222, 0.100106, 1.363397, 0.474213, -0.077860, 0.262310, 0.775410, -0.281544, -0.060431, 1.678168, -0.335113, 0.669164, 0.578528, 1.123572, 0.371947, -1.743158, -0.602828, 0.361852, 0.182274, 1.387660, 0.994415, 0.351315, 0.058570, -1.094939, 1.317453, 0.094771, -1.093189, 0.306377, 0.072800, -0.403296, 0.348648, -0.500287, -0.953198, -1.240479, -0.257252, -0.443422, 0.311233, -1.062528, -0.147245, -1.064284, 1.279680, -0.082712, 0.867061, 0.349978, 0.642474, -0.816156, 0.889226, 1.027096, -1.468527, -0.124796, -0.461092, 0.110686, -0.601200, 0.197315, 0.422209, 0.173041, -0.083684, -0.911749, 0.040704, -0.368355, -0.904409, -0.039759, -0.148266, 0.135836, 0.701685, 0.407466, 0.923329, -0.515697, -0.611347, -0.067119, 0.978080, 0.921842, -0.088963, -0.422054, -1.075259, 0.475064, 0.016153, -0.832822, -0.236582, -1.293620, 0.304049, -0.123032, 1.153463, -0.961261, 0.686252, 0.101569, 0.058410, 0.506758, 0.843921, -0.757355, 0.932605, -0.855601, -0.759514, -0.475572, 0.520757, -0.756576, 0.236679, 0.291245, 0.108979, 0.392141, -0.829327, 0.712471, 0.080271, 0.516224, -0.695448, 0.036792, 0.620556, 0.717106, -0.059643, -1.310645, -0.775569, 0.154593, 0.561617, 0.327478, -0.433195, 1.587030, 0.051157, 0.612011, -0.293942, -0.788380, 0.484547, 0.733746, 1.288498, -0.374051, -1.151146, 1.143606, 0.186773, -0.797013, -0.395397, -0.571940, 0.820954, 0.418682, 0.171649, 0.170043, -0.580889, 0.702236, 0.244938, -0.184649, -0.130612, -0.071938, -0.627234, 0.524233, 0.984440, 1.749312, 0.356325, -0.581582, 0.142116, -0.712094, -0.433578, -0.465957, -0.589182, 0.267413, -0.788666, 0.471811, 0.562385, 0.733618, -0.014447, 0.437666, 1.274958, 0.037472, -0.125787, 1.253334, -1.773992, -0.322857, 1.718536, -0.333368, -0.396212, -0.867243, 0.560701, -1.491953, -0.565258, 0.400912, -0.001020, 0.441181, 0.089407, 0.481446, -0.910341, 0.154209, -1.107730, 0.553864, -0.219606, 0.463384, -0.380047, 0.232386, 0.745341, -1.399859, -1.320443, -1.295671, 0.600045, 0.286511, -0.496711, 1.059986, 0.097436, -1.122052, -0.720645, -0.979508, 0.675207, -0.425056, -0.828652, -0.408079, -0.591446, 0.603141, 0.337524, 0.213773, 0.293998, 0.030388, -0.670941, 0.382975, -0.580625, -0.757951, -0.759497, 0.614867, 0.693708, -1.243677, -0.104720, 0.178150, -0.431607, 0.538094, 0.179909, -0.108070, -0.394149, 0.478724, 0.600544, 0.331850, -0.169551, 0.651235, -0.641262, 0.102135, 0.987410, -0.134137, -0.596682, 1.374218, -0.174600, 0.312272, -0.568239, 0.203371, 0.330232, 0.003226, 0.230581, 0.851771, -0.992860, 0.145355, -1.407988, 0.020088, 1.365081, 0.665484, -0.004896, -0.239173, 0.373540, 0.747341, 0.010423, 1.141809, -0.576897, -1.412629, -0.529051, -0.140929, -0.263581, -0.599182, 0.945570, -1.142909, -0.347768, -0.685400, -0.335245, -0.471049, 0.338262, -0.736139, -0.580294, 0.071509, 0.766491, -1.311349, 1.272617, -0.621104, 0.458016, 0.742155, 0.935568, -0.365828, 0.017193, -0.114811, -0.428267, 0.192128, 0.253599, -0.249124, 0.093593, 1.890508, -0.005350, 0.502260, -0.327065, -0.373266, -0.244508, 0.399203, -0.566774, -1.310231, 0.037629, -0.308592, 0.197995, 0.059825, 0.515565, 0.636929, -0.937368, -1.078040, 0.355274, 0.216651, -0.664087, 0.874975, 0.023343, 0.087376, 0.193704, 0.533276, 1.077983, -0.185245, -1.223778, 0.716627, -0.656008, 0.879415, -0.416831, 1.054637, -0.569913, -0.786726, 0.676658, -0.963823, 0.481246, 0.309588, -0.101305, -0.241500, 1.455092, -0.264836, -0.134494, -0.663784, -0.575205, -0.412681, 1.208817, -0.276069, -0.487950, -0.316940, 0.505140, -0.930362, 0.443442, -0.941368, -0.092524, -1.291811, 0.378954, 0.489929, -0.486171, 0.224560, 0.115147, 0.819619, 0.090784, 0.735008, -0.082570, -0.458415, -0.026857, -0.140944, 0.623435, -0.039700, -0.594846, -0.109491, 0.840463, -0.293384, -0.465712, 0.695786, 0.071579, -0.256472, -0.522430, -1.046407, 0.108450, -0.224165, 0.225509, -1.029934, 0.934678, 0.344505, -1.107772, 0.747454, -0.415480, 0.213703, 0.155183, -0.620982, -2.023315, 0.378695, -0.241857, -0.422750, 0.296216, -0.487678, 0.474604, 0.106701, -0.700968, 0.591728, 0.335529, 0.885415, -0.631180, -0.633054, 0.221555, 0.471664, 0.585567, 0.004603, -0.166801, 0.461614, 1.389134, 0.625495, 0.059777, -0.406243, 0.353377, -0.342314, 0.168607, 0.550305, 0.653560, 0.415876, 0.974347, 1.309000, -1.341852, -1.257720, -0.652406, -1.412748, -0.252508, -0.237871, 0.177078, 0.202347, -0.485194, -0.575100, 0.561020, -0.270076, -0.969588, 0.007288, 0.144343, -0.290639, 0.469209, 0.159652, -0.150503, -0.031137, 0.323983, -0.312129, -0.745960, -0.110015, 0.091321, 0.360220, -0.021301, -0.323406, 0.421673, -0.080277, 0.570652, -0.063500, -0.004449, -0.064955, -0.651414, -0.655454, -0.679686, 1.262065, -0.141555, 0.664971, 0.246891, 1.314710, 0.655539, -0.867594, -0.231393, 0.630489, 0.203778, 1.601735, -0.033864, -1.097334, 0.314014, -0.644753, 0.034956, 0.762294, 0.217915, 0.211876, -0.139455, -0.103536, -0.072882, -1.979179, 0.278088, 0.700210, -0.917565, -1.076194, 0.439121, -1.065979, -1.187517, 0.557890, -0.462647, 0.880279, -0.913769, -0.434413, 0.170904, 0.388449, 0.330667, 0.135381, -0.162497, -0.409568, 0.339751, -0.273532, 0.298127, 0.769124, -1.590518, 1.275960, -0.446934, 0.930877, 1.097141, -1.038675, 0.125114, 2.451016, -0.151764, 0.343854, 0.233971, 0.896542, 0.771110, -0.669242, -0.310066, 0.242694, -0.041297, 1.792498, 0.310169, 0.309372, -0.592326, -0.924544, 0.561544, -0.139487, 0.459020, -0.587941, 0.633535, -1.282329, 1.107812, 0.598566, 0.077891, -0.821023, -0.281100, 0.179813, 0.854036, -0.730824, 0.915807, 1.957359, -0.350263, 0.331467, -0.464779, -1.214072, 1.039814, 0.490829, -0.361117, 0.080177, -0.162498, -1.033601, -2.038119, -0.033565, -0.327013, -0.407750, -0.598190, -1.284980, -0.368919, 0.114152, -0.750814, 0.318547, -0.192897, -0.071739, -1.010531, -0.540519, 0.290011, -0.558567, 0.114295, 1.398589, 0.562338, 0.733529, 1.669005, 0.831130, 0.281245, 1.379741, -0.639689, -0.482354, 1.427148, 0.321269, -0.029772, 0.323973, -0.186778, -0.206465, -0.273508, -0.391732, -0.667316, -0.042319, -0.406363, 1.019546, 0.166543, 0.722222, -0.098875, -0.057665, 0.889715, 1.038410, 0.023293, 1.196763, 0.336391, 0.260590, 1.549979, 1.085893, 0.641530, 0.284440, -0.380694, -0.081470, 1.288349, -1.429421, -0.450411, -0.133504, 0.104846, -1.261394, 0.374107, 0.515998, -0.664776, -0.183344, -0.858106, 1.148730, 0.264113, -0.177407, -0.654396, 0.069763, 1.190966, 0.194638, 0.249813, -0.848794, 0.117471, 0.548829, -0.976822, 0.797814, 1.743329, -1.101614, -1.461341, -0.051335, 0.536773, -0.057745, -0.112058, 0.004595, -0.752791, -1.162423, 1.118325, 0.206909, -0.839766, 0.760802, -0.917380, -0.086105, 0.523805, -0.594477, -0.247113, 0.020953, 1.380537, 0.324579, -0.282356, -0.159371, -0.198190, 0.923994, -0.201084, -0.559824, 0.170143, -0.066925, 0.560902, 0.678426, 0.768698, 0.457617, 0.447281, 1.345820, -0.820262, -0.245585, -1.198592, 0.650104, 0.015225, -0.211666, -1.216942, 0.129706, -0.183658, -0.957980, -0.818435, -0.538806, -0.176989, -1.165852, -0.128687, 0.435357, -0.266349, -0.493585, 0.215047, 0.778581, -0.315800, -0.330015, -1.015279, -0.691350, 0.428432, -0.080366, 0.540627, 0.473689, 0.265719, 0.542105, 1.077257, 0.407876, 0.301208, -0.030357, -0.878413, -0.357055, 0.230412, -0.785895, 0.331056, 0.228122, 0.070726, 0.213146, 0.016846, -0.015595, -0.006193, 0.657224, -0.063945, -1.867572, -0.343760, 0.138571, 0.678626, 0.976037, -0.665715, 0.538015, 0.168235, -0.147342, 0.017493, -0.019863, 0.099249, 0.167999, -0.474857, -0.738927, 0.682900, -0.155391, 1.000228, -0.653499, -0.420121, 1.004994, 0.995329, -0.727613, 0.146026, 0.948309, 0.942373, -0.908558, 1.144365, 0.467853, 0.160758, -0.159506, -0.683061, 0.067188, -0.181537, 1.633510, 0.134393, -0.122615, -0.009920, -0.433271, 1.464984, 0.450444, 0.052958, 0.794270, -0.023425, -0.069118, -0.393590, -0.435224, 1.134590, 0.543408, 0.061471, 1.205164, 0.016712, 0.205091, -1.004020, 0.336069, -1.023409, -0.698819, 0.671313, 0.248353, -0.616796, -0.281518, 0.181328, 0.155581, -1.210171, -0.852598, -1.253639, -0.051259, -1.217012, 0.496305, -0.710973, -0.782362, 1.266117, 1.529037, -0.579317, -0.026198, 1.388053, -0.382026, 1.214459, 0.579692, 0.039259, -0.249697, 1.197237, 0.502789, -0.447432, 0.277699, -0.620813, 0.105320, 1.083201, 0.376073, -0.537166, 0.246062, -0.493421, 1.427871, -1.268337, -0.466342, 0.545500, -0.580069, 0.012649, 0.462826, 0.889327, -0.655545, -0.120122, -0.333523, -0.080775, 0.261267, -0.437427, 0.565767, 0.301720, -0.333988, 0.195127, 0.695954, 0.702233, 0.472495, -0.045961, -0.438476, 0.158466, -0.329608, -0.234821, 0.653943, 1.023202, 0.421317, 1.451882, -1.081343, 0.016043, 0.067377, 1.141643, 0.354454, -0.228990, 0.391890, 0.454276, 0.129135, -1.433642, 0.723427, -2.468893, 0.077421, -1.096957, -0.251101, 0.988929, -0.363082, 1.355651, 0.550419, -0.174270, -0.638893, -0.350656, 0.264808, -1.676219, 0.434915, 0.197612, 0.579025, 1.447806, -0.228922, -0.693348, 0.834127, 0.632566, -0.101067, -0.419647, 0.176011, -0.798877, 0.046736, -0.451081, -0.579338, 0.684446, 0.021460, 0.955370, -0.768183, 0.169893, -0.739762, 0.437499, 0.922799, 0.723717, -1.495801, 0.482055, 0.006158, 0.236367, -0.387079, -1.167422, 0.631300, -0.358542, -0.233198, 0.119044, 1.793746, 1.621839, -0.932434, -0.335264, 0.698185, -1.465851, 0.879659, -0.222908, 0.989450, -0.622170, -0.652287, 1.636530, 0.415788, -0.219039, -0.730416, 0.780187, 0.241908, -1.600885, -0.638720, 2.100128, -0.008320, -1.413888, -0.627922, -0.296916, 0.491141, -0.115084, 0.071826, -0.012628, -0.679054, 0.829299, -0.258287, -0.327681, 0.137878, -0.047338, -0.368777, 0.089873, 1.494130, 0.382744, -0.463215, -0.614850, -0.168926, -1.114391, 1.291001, 0.144439, -0.822645, 0.085284, -1.020722, 0.411781, -0.128315, 0.029705, 0.255861, 0.603667, -0.572595, -1.037361, -0.073466, -0.581888, 0.300507, -1.311460, 0.607104, 0.216653, -0.785993, -0.224323, 0.592458, 1.715770, -0.248258, 0.977195, -0.608575, 0.146294, -0.146723, 0.240598, -0.352218, -1.005078, -0.191466, 0.310889, -0.357898, -0.130354, 0.284256, 0.381292, -0.518729, -0.189768, 0.615606, 0.233883, -0.953107, 1.094511, -0.436028, -0.493964, -1.006634, -0.077522, -0.072628, -0.228195, -0.593678, -1.174187, 2.130150, 1.061254, -0.253845, -0.081232, 0.253781, -0.008582, -0.403305, 0.660462, -0.804912, 1.383976, -1.246792, -0.228632, 0.617016, 0.083379, -1.062820, 0.651836, 0.115432, -0.576059, 0.285466, 0.534684, 1.544632, -0.066314, -0.208035, -0.356951, -1.362594, 0.368672, -1.452688, -0.190804, -0.194477, 0.597608, -1.959521, 0.649177, -0.367168, -0.914298, -0.006165, 0.165005, -0.299952, -1.039057, 0.853068, 0.139542, -0.499836, 0.860102, 0.259629, -0.896269, 0.439149, -1.269578, -0.748005, 0.107158, 0.290808, 0.049849, -1.366856, 0.578924, 0.892197, 0.825436, -0.403284, -0.278528, -0.719434, 0.176922, 0.178279, -0.545518, 0.650217, 0.602566, 0.464658, -0.532780, -0.946464, 0.461193, 1.023337, -0.912257, -1.561426, 1.015482, -0.043609, 0.832835, 0.696863, -0.861665, -0.305384, -0.590393, 0.127053, 0.824700, 0.039588, -1.484954, 0.873487, 0.001889, -0.324942, -1.487170, 0.264403, 0.173369, 0.239412, -0.762307, -0.516303, -0.647941, 1.263991, -0.580113, -0.139096, -0.629427, 0.643997, -0.008673, 0.051488, 0.664268, 0.477465, 0.555764, -1.508075, 0.155514, 0.683267, 0.247483, 0.637680, 1.499907, 0.882884, -0.794212, -0.586959, -0.086111, -0.454380, -0.055826, 0.868407, -0.375732, -0.202307, -0.160942, 0.476960, 0.733157, -0.105686, -0.224210, 0.660151, 0.511439, 0.345199, 2.309551, 0.022416, 0.241318, -0.059065, 0.435876, -0.371230, 0.712556, 1.293371, 0.060308, -0.048313, -0.398430, -0.334867, -1.204581, -0.037986, -0.623204, 0.888049, 0.110197, 0.038843, 0.988926, -1.255573, 0.233101, -0.748050, -0.454931, 0.182745, 0.630523, -0.591581, 0.391135, 1.031251, -0.604634, -0.701537, -0.008273, 0.443293, 0.001060, -0.577230, 0.081422, 0.146420, -0.314353, -0.792306, 0.307845, 0.012083, -0.256670, -0.446352, -0.353783, -0.613198, -0.735457, 0.894795, -0.170736, -1.222610, -0.345238, 0.749805, -0.380532, 1.256768, -0.551203, -0.532432, -0.730536, 0.822958, -0.410197, 0.295077, -1.165400, -0.404943, 0.466147, -0.905381, 0.035443, 0.387779, 1.257552, 0.453317, 0.669420, -0.250496, -0.409286, 0.039933, -0.631675, 0.793429, 0.548594, 0.680587, 0.891509, -0.076310, -0.408112, 0.371678, 0.814559, 0.606966, 0.668623, 1.064995, 0.208835, 0.851425, -0.008376, 0.558261, -0.992482, 1.090434, -1.255049, 0.145421, -0.244807, -0.819525, 0.237465, 0.234931, 0.997876, 0.096777, 0.408445, 0.171889, 1.037800, 0.799422, 0.007533, 0.087917, 1.258248, -0.169332, 0.606692, -0.621091, -0.538777, 0.610079, 0.458421, 0.748184, -0.447734, 0.719827, 0.121570, -0.033569, 1.194406, 1.016144, -1.591753, 0.252076, -0.601212, -0.211815, -0.448481, 1.148679, 0.877569, 0.392643, 0.497391, 0.323970, 0.483650, 0.177689, -0.126221, 0.359016, -0.219132, -0.278862, -0.190734, -0.062317, 0.005678, 1.790250, -0.864963, -0.757842, 0.173990, -0.035788, -0.516294, 0.231215, 0.532445, -0.815804, -0.288406, -0.910687, 0.059098, 0.115824, 0.482653, -0.768178, 0.210359, -0.101334, 0.984260, 0.216903, -0.379847, -0.161880, -0.379165, 1.017542, -0.361402, -1.136204, -0.142300, 0.808579, 0.469018, 0.116025, 1.262472, -0.415575, 0.183166, -0.616479, -0.557141, -0.243485, 0.457934, 1.452487, 0.564937, -0.757366, -0.145067, -0.392050, -0.207142, 0.834550, 0.266859, 0.701149, 0.426705, -0.560655, 0.658188, -0.954869, 0.565537, 0.424008, 0.778121, -1.003909, -0.143992, 0.012666, 0.070959, 0.619678, 0.495466, 0.461045, 0.126240, 1.185118, -0.229879, 0.071522, -0.407783, -0.043507, 0.513068, -0.867862, 0.135008, -0.519595, 0.557472, -1.389735, -1.382764, 1.148549, -0.105656, -1.391776, -1.192279, -0.061463, 0.217355, 0.238681, 0.754477, 0.235425, -0.051961, 0.740876, 1.455836, 0.018875, -0.170076, 0.734313, -0.358662, -1.048696, -0.075298, 0.173428, 0.103091, -0.790606, -0.422101, -0.480471, 0.675325, -0.092490, 0.459198, 0.423214, -0.136118, -1.400636, 0.256636, 0.497768, -0.532166, -0.011962, -0.312304, 1.203025, -0.021616, 0.144192, -0.740914, -0.519985, -0.959235, 0.515188, 0.429346, -0.585686, 2.041873, 0.649927, 0.286936, 1.354947, -1.736433, -0.064392, -0.017451, 0.141376, -0.734199, 0.374319, -1.567740, 0.075955, 0.310356, -0.028987, 0.257605, -0.540016, 0.388572, -0.264909, -1.173203, -0.219365, -0.438366, -0.724495, 0.357088, 0.028619, -0.180121, -0.387308, 1.185531, 0.829438, -0.133687, 0.061216, 1.069542, 1.268034, 0.779670, -0.230409, -0.412112, 0.531452, -0.610752, -0.757223, -0.251190, 0.675909, 0.112629, 0.173200, 0.795318, 0.165907, -0.805085, 0.595450, 0.336825, -0.062501, -0.292060, -0.385079, -0.016975, -0.566049, -0.362173, -1.051238, -0.366735, -0.490187, 0.408461, 1.028817, 0.732198, 0.740216, 0.478153, 0.386501, 0.530322, -0.516074, 0.589163, -0.847503, 0.437539, -0.588605, -0.686243, -0.320681, -0.921153, 0.011296, 0.785355, -0.176334, 0.350514, 0.114578, 0.856887, -0.111946, 0.207162, 1.744938, 0.810510, -0.660327, 0.791813, -0.653527, 0.007005, 0.204613, 0.615185, -0.280907, 0.380323, 1.251393, -1.347381, -0.761376, 0.844951, -0.207853, -0.026996, 0.653320, 1.571942, -0.920579, -0.642754, -0.054801, 0.000361, 0.075558, -0.220946, 0.862420, -0.643157, 0.144233, 0.699857, 0.265306, -0.439910, 0.085245, -0.224433, -0.424041, 0.956824, -0.139772, -0.408709, -0.534551, 0.085701, -1.057720, -1.164010, 0.136399, -0.912005, -0.282736, 0.548293, 0.652059, 1.092152, -0.713868, 0.605783, 0.230012, 0.885608, 0.155676, 0.576431, 0.805693, -0.291124, -0.326022, -0.939779, -0.061872, 0.251338, -0.525478, 0.050933, -0.252015, -0.305252, 0.551068, 0.577229, 0.811974, -0.767183, -0.096253, 0.463220, -0.914615, 1.362411, 0.164934, -0.385389, 0.730309, 0.266676, 0.077255, -0.480966, -1.248321, -0.681345, -0.456531, 0.319985, 0.434516, -0.555291, 0.585609, 0.471935, -0.088743, -0.672620, 0.630768, -0.091727, -0.716642, 0.178394, 0.370231, -1.033528, 1.319748, -1.519609, -1.156287, 0.865512, 0.229933, -0.303287, 0.008200, 0.517120, -0.613785, 0.656308, 0.493077, -0.031926, 0.135207, -0.444603, -0.605717, -0.274861, 0.727265, -0.169508, -0.319346, -0.692446, -0.801468, 0.015642, 0.735560, 0.870791, 0.396107, -0.218523, -0.259935, 0.258542, 0.662869, 0.688894, -1.498306, -0.032856, -0.683617, -0.333223, 1.226991, -0.549797, -1.190625, 0.125177, -0.088019, -0.293842, 0.621871, 0.400313, 0.265813, -0.195836, 0.247557, -0.205985, 0.131577, 0.407717, 0.240174, -0.475761, -0.379726, -0.735503, 0.705187, -0.018423, -0.464569, 0.479239, -0.361214, 0.315373, 1.072423, 0.663094, -0.113252, -0.080496, 1.369755, -0.120773, 0.212958, 0.230509, 0.653958, 0.152234, 0.258977, 0.227795, 1.901413, 0.619474, -0.619772, -0.860865, -1.141864, 1.301133, -0.579068, 0.701546, 0.377466, -1.079559, 1.430377, 0.390532, 1.287035, 0.242286, 0.126969, -0.720767, 0.026587, 0.096961, -1.075546, -0.013377, 0.115433, -0.509931, 0.290340, -0.857460, -0.405699, 0.074524, -0.427868, 0.298254, -0.256545, -0.618093, 0.658736, 0.424294, 0.404013, 0.484446, 0.713768, 0.700651, 0.023823, -0.318389, -0.078246, 0.875298, -0.847015, -0.399087, 0.737731, 0.598214, -0.350397, -0.146242, -0.110165, -0.194736, -1.727638, -0.302163, 0.218539, 1.733525, -1.034234, -0.449396, -0.272570, -0.666291, -0.476430, -1.360646, -0.079491, -0.366642, 0.378290, 0.040594, 0.753647, 1.146034, 0.086164, -0.875427, 0.172623, 0.988718, -0.067510, 0.274091, -0.683288, 1.067156, 0.285551, -0.298499, -1.183714, -0.486228, -0.726330, -0.348291, 0.245231, 0.586441, 0.110049, 0.059195, 0.264894, 1.876097, 0.235264, 0.099540, 1.115698, 0.063320, -0.475871, 0.658948, -0.253067, 0.142907, 0.619603, 0.571306, -1.133728, -1.670223, -0.496177, 1.168072, 0.166222, -0.107305, -0.110230, 0.734093, 0.233687, 0.336446, -1.478208, -0.123061, 0.013568, -0.608131, -0.016228, -0.425903, 0.615113, -0.403625, 0.922548, -0.030154, 0.633236, 1.615637, 0.047254, 1.056834, -0.758347, 1.289299, -0.854488, -0.046239, -0.231108, -0.812572, -0.924925, 0.457062, -0.982315, -0.948006, 0.798233, 0.001199, 0.268477, -0.637338, -0.139155, 0.217040, 0.118410, 1.264363, -0.441293, -0.106038, 0.588465, 0.670402, -1.395643, -0.277100, -0.478507, -0.011329, 0.364284, 0.314542, 0.806737, 0.316558, 0.223050, 0.668634, 0.303111, -0.936639, 0.077656, -1.170065, 0.785364, -1.490483, -0.388793, 0.066652, -0.027025, 1.331431, 0.039217, -0.434086, 0.415083, -0.853272, 0.385607, 0.177435, -0.277714, -0.439850, -0.841794, -1.328277, -0.299819, 0.549593, -0.504822, 1.120509, -0.628131, 1.513795, -0.489444, 0.070214, 1.014683, 0.872146, -0.535736, 0.522254, -0.787972, -1.206232, 0.467512, -1.223042, -1.511846, -0.042460, 0.979831, 0.861126, -1.057161, 0.026363, 0.567715, 0.688618, 1.103605, 1.121648, 0.605494, -1.007262, 0.028074, -0.975745, 0.871913, 1.231834, -1.415271, 0.590786, -0.242409, -0.337970, -0.628690, 0.893379, 0.270964, -0.084052, 0.295038, 0.716456, -0.614842, -0.561924, 0.486845, 1.121240, 0.884010, -0.081744, -0.941703, -1.656614, -0.655179, 0.798725, -0.388292, 0.200629, 0.150458, -1.557589, 0.884642, 1.431683, -0.027504, 0.706105, -0.535516, 0.421538, 1.501341, 0.927530, -0.494933, -0.720975, 0.037558, -0.167598, -0.044361, 0.898810, 0.156368, 1.176642, -0.030377, -0.094212, 0.560877, 0.301420, -0.148423, -1.122998, -0.789400, 0.436182, 0.384287, -1.037959, 0.084788, 0.374311, -0.831023, -0.705845, 0.844315, -1.240051, 0.315744, 0.691593, -1.266610, -0.092058, -0.831018, 0.063613, -0.298516, -1.167386, 0.436970, 0.421549, -0.437301, 0.373264, -0.950576, -0.873111, -0.815605, -0.077307, -0.370662, 1.351492, -0.050280, 0.397278, 0.405930, 0.262855, 0.135548, 0.879701, -0.823185, 1.156310, 0.485308, -0.812810, 0.785000, 0.836199, 1.207263, -0.297208, 1.159215, 0.186300, -1.034839, -0.548836, 0.657247, 1.267813, -0.836615, -0.078613, -0.464404, 1.329173, -0.633625, 0.941517, -0.441640, 0.549195, -0.936389, 1.060856, -1.557688, 0.228052, 0.297695, -0.580323, -0.683390, 0.430874, -0.732712, -0.019967, -1.993876, -1.471524, -0.031645, 0.790514, -1.166375, 0.479890, 0.349539, -0.416110, -0.016917, 1.549492, -0.990360, 0.339482, 0.146760, 0.227748, -0.004158, 0.198972, -0.177724, -1.197457, -0.412962, 0.165776, 0.182989, 0.426850, 1.570460, -1.169647, 0.481123, 0.096046, -0.026861, -0.490122, -0.090174, 0.481088, 0.301379, -1.135380, 0.640788, 0.176433, 1.339422, -0.786570, -0.510561, -1.238983, 0.002554, 0.703673, -0.338682, -0.367060, -0.208356, -0.113526, 0.723735, 0.011239, -0.341290, 0.448783, -0.964803, 0.423292, -0.146016, 1.512760, -0.458781, 0.299525, 0.083343, -0.764226, 0.619091, -1.574219, -1.376109, -0.926023, 0.923215, 0.695772, -0.884864, -0.127105, -0.525668, 0.164927, 1.485875, -0.619897, 1.378002, -0.328997, -0.460975, 0.431074, 0.501426, 0.197846, -1.037648, -0.488835, -0.613761, -0.362398, -0.553019, 0.301078, 0.715267, -0.177249, 0.391904, 0.536610, 0.094641, -0.192730, -0.383696, -0.822439, -0.193406, 0.112786, -0.132023, 0.154081, 0.032695, 0.473991, -0.445831, -0.083729, 0.171166, -0.265932, 0.198304, -1.254727};
   int Noise_len = sizeof(Noise)/sizeof(Noise[0]);
   printf("Noise length = %d,", Noise_len);
   double Noise_pulse[samp_fact*pulse_len], pow_Noise[100000], Bpsk_error[10];

   int ENoBdB[]={0,1,2,3,4,5,6,7,8,9};

   for ( k = 0; k<10; k++)
   {  double aa = ENoBdB[k]*1.0/20;
      for (i=0; i<pulse_len; i++)
       {    pow_Noise[i] = pow(10, -aa)*Noise[i];               }

   ///  NOISE ADDITION  ///
      for (i=0; i<pulse_len; i++)
       {    Noise_pulse[i] = pow_Noise[i] + pulse[i];           }

   ///   MATCH FILTER   ///
       double Match_pulse[pulse_len + gmsk_len];
      for ( i = 0; i < (pulse_len + gmsk_len - 1) ; i++ )
       {   Match_pulse[i] = 0;
           for ( j = 0; j <= i; j++ )
             { Match_pulse[i] = Match_pulse[i] + ( Noise_pulse[j] * gmsk_bada[ i - j ] );}
       }

   ///  BEST SELECTION  ///
       double Best_pulse[samp_fact*len];
      for ( i = gmsk_len; i<pulse_len+1; i++ )
       {  Best_pulse[i - gmsk_len] =  Match_pulse[i];           }

   ///   DOWNSAMPLING   ///
       double Dn_output[len];
      for ( i = 0; i<len; i++ )
       {    j = samp_fact*i;
       Dn_output[i] = Best_pulse[j];   }

   ///   DEMODULATION  ///
      int output[len];
      for ( i = 0; i<len; i++)
       {   if ( Dn_output[i] > 0 )
           {  output[i] = 1;}
           else
           {  output[i] = 0;} }

    ///     Error     ///
      int Error[len], total_error = 0;
      for ( i = 0; i<len; i++)
       {    Error[i] = input[i] - output[i];
           if (Error[i] == -1)
           { Error[i] = 1; }
           else
           { Error[i] = Error[i]; }
       total_error = Error[i] + total_error;
       }
       float mean_error;
       mean_error = (total_error*1.0)/len;
       Bpsk_error[k] = mean_error;
       printf("\nmean_error = %f, with db=%d", mean_error, k);
 }
    return 0;
}


/// CLOCK CYCLE = 260,475,576 ///
